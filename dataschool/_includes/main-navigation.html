
{% assign book = site.books | where:'slug', page.book %}
{% assign book = book[0] %}
{% assign bookchapters = site.chapters | where:'book', page.book | sort: 'number' %}


<nav class="sidebar">
  <!-- Main nav elements, always include in sidebar -->
  <div class="sidebar-header">
    <a href="/"><img src="/uploads/dataschool-small.png"></a>
  </div>
  <ul class="list-unstyled components">
    <li><a href="/books/">Books</a></li>
    <li><a href="/mission/">Mission</a></li>
    <li><a href="/people/">Contributors</a></li>
    <li><a href="/books/">Slack Community</a></li>
  </ul>
  <!-- showing the current book -->

  <!-- building the chapter list -->
  {% if page.layout == "chapter" or page.layout == "book" %}
  {% include smallbook.html %}
    <ul class="list-unstyled components">
      <li class="d-none">
        <ul>
          {% for chapter in bookchapters %}
            {% if currentsection != chapter.section %}
              {% assign currentsection = chapter.section %}
                </ul>
                </li>
                <li class="book-section ">
                  <a href="#{{currentsection}}" data-target="#{{currentsection}}" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle">{{ currentsection }}</a>
                  <ul class="collapse list-unstyled {% if currentsection == page.section %}show{% endif %}" id="{{currentsection}}">
            {% endif %}
            <li>
              <a href="{{ chapter.url }}">
                {{ chapter.title }}
              </a>
            </li>
          {% endfor %}
        </ul>
      </li>
    </ul>
  {% endif %}
</nav>
